# Informe de: El Ventanal de Guillermo

# 1. Formulario de autorización de Pentesting

Cliente: La Descuidada S.A

Fecha: 4 de Abril de 2024

Autoriza a Grupo 1 para llevar a cabo las actividades de verificación de seguridad de dos servidores. 

Condiciones:

- Las pruebas serán externas e internas y se realizarán desde fuera y dentro de la red del cliente utilizando Internet y para acceder a los activos en el alcance
- Se realizarán varios tipos de Test para comprobar la seguridad de las aplicaciones.
- Planificación Temporal:
    
    Fechas: Del 5 de abril al 7 de abril de 2024.
    

# 2. Tipos de pruebas (Pentesting)

El servicio de tests de intrusión nos permite testear la fortaleza de la infraestructura IT para medir su nivel de seguridad técnico y si cumple los niveles requeridos por la política organizativa. Estos test son realizados por expertos en seguridad sobre todos los servicios expuestos a internet y aquellos que puedan accederse remotamente.

Se pueden realizar dos tipos distintos de Test de intrusión, Externo o Interno dependiendo desde dónde se lancen los ataques:

- **El Test de Intrusión Externo:** Se realiza desde Internet sobre la infraestructura del cliente, más concretamente, sobre aquellos dispositivos de la organización  que están expuestos a Internet.
- **Test de Intrusión Interno:** Se realiza desde dentro de la red del cliente desde donde pueden localizarse más problemas de seguridad que desde fuera.
- **Propósito del pentest:** Comprobar el estado de las vulnerabilidades que presenta los servidores del mismo

Se pueden realizar solo un tipo distinto de Test de Intrusión, Externo o Interno dependiendo desde dónde se lancen los ataques:

- **Test de Intrusión de Caja Negra:** Este es un tipo de test de intrusión externo, sin información o solo con muy poca información del objetivo.

Dada la naturaleza de los trabajos a realizar cabe la posibilidad de que, de forma no intencionada, se produjese algún efecto colateral indeseado. Si así fuese, el Auditor de Grupo 1 lo notificaría inmediatamente y se pondría a disposición del cliente para aportar información requerida sobre las acciones realizadas.

## 2.1 Restricciones y conformidades

Las siguientes restricciones se aplicarán a esta autorización:

- Esta autorización estará vigente desde el 5 de abril al 7 de abril de 2024, ambos inclusive.

De conformidad con la concesión de esta autorización, el Cliente declara que:

- El cliente es dueño de los sistemas donde se realiza la auditoria de vulnerabilidades y el suscrito tiene la autoridad adecuada para poder llevar a cabo las actividades de verificación de seguridad de aplicaciones.
- El cliente ha creado una copia de seguridad completa de todos los sistemas dentro del ámbito de las pruebas de vulnerabilidades y se ha comprobado que el procedimiento de copia de seguridad permitirá al cliente restaurar los sistemas a su estado pre-test.
- El servicio implica necesariamente el uso de herramientas y técnicas diseñadas para detectar las vulnerabilidades de seguridad, y que es imposible identificar y eliminar todos los riesgos que implica el uso de estas herramientas y técnicas.
- El cliente se compromete a no modificar el sistema o aplicativo durante la ejecución del pentesting. Si esto sucediera se entenderá como un cambio de alcance, de tal modo que el pentesting se dará por finalizado y se entregará el informe al cliente con los resultados obtenidos hasta ese momento, con lo que el auditor cumplirá totalmente con el alcance inicialmente acordado. Si el cliente desea realizar un pentesting al sistema o aplicativo que ha modificado deberá volver a negociarlo con Grupo 1 considerándose en todo caso como el encargo de un nuevo trabajo.

Cualquier cambio a las limitaciones y condiciones descritas deberá realizarse por escrito y ser aceptado por ambas partes.

## 3. Acuerdo de Confidencialidad

Será considerada como “Información Confidencial” toda aquella información, ya sea técnica, financiera, comercial o de cualquier otro tipo, suministrada y divulgada por la empresa cliente a Grupo 1 en relación con el alcance del contrato, mediante cualquier tipo de soporte, tangible o intangible, actualmente conocido o que posibilite el estado de la técnica en el futuro o de forma verbal.

## 3.1 Obligaciones de Grupo 1

Nada más recibir la Información Confidencial, Grupo 1 la mantendrá en estricta confidencialidad, la utilizará solamente en relación con las pruebas del alcance, no la revelará a una tercera parte sin el precio consentimiento escrito de la empresa cliente y sólo podrá revelar dicha Información Confidencial a los empleados de su compañía o que tengan necesidad expresa de conocerla en relación con las pruebas contratadas.

Grupo 1 no podrá copiar ni reproducir la Información Confidencial suministrada por la otra Parte en formato o soporte alguno, excepto si ello fuera preciso con arreglo a lo previsto en el párrafo anterior. Toda copia o reproducción que se haga deberá contener el mismo sello, marca o leyenda que su original.

## 3.2 Tarifas y pagos

El Cliente acuerda pagar al Proveedor las tarifas acordadas por adelantado, según lo estipulado en un acuerdo financiero separado.

## 3.3 Exclusiones

Las Partes acuerdan que las obligaciones contenidas en este acuerdo no se aplicarán respecto de aquella información que:

- Sea o llegue a ser de público conocimiento sin mediar acto proveniente de Grupo 1 en contravención de los términos de este Compromiso.
- Deba ser difundida por imperativo de una disposición legal, contractual o judicial.
- Sea explícitamente identificada, de conformidad con este Compromiso, como Información no Confidencial.
- Cuya comunicación o uso sin restricciones haya sido aprobada por la empresa cliente.
- Sea independientemente generada por Grupo 1 sin hacer uso de la Información Confidencial.
- Haya sido requerida a la Parte receptora mediante una resolución firme por Autoridades Administradas o Judiciales competentes. En este caso deberá notificarse.

Inmediatamente esta circunstancia a la empresa cliente sobre el requerimiento recibido, siempre que no exista obligación de guardar secreto sobre el mismo por mandato legal, administrativo o judicial. Asimismo, Grupo 1 sólo revelará aquella parte de la información que sea requerida.

## 3.4 Derechos de propiedad

Este Acuerdo no supone la concesión, expresa o implícita, de derecho alguno sobre la Información Confidencial que la empresa cliente suministre, salvo el que en cada caso sea otorgado expresamente en relación con el Alcance del presente contrato.

En consecuencia, el suministro de dicha Información no podrá entenderse, en ningún caso, como concesión de patente, licencia o cualquier otro derecho de propiedad intelectual y/o industrial alguno, considerándose que aquella permanecerá en todo momento en el ámbito de propiedad de la empresa cliente o del tercero a quien pertenezca

## 3.5 Vigencia

Las obligaciones previstas en la cláusula 2 permanecerán en vigor hasta que hayan transcurrido 3 años contados a partir de la fecha de entrega del informe de resultados del presente contrato.

## 3.6 Legislación aplicable

Este compromiso se interpretará de conformidad con las leyes españolas.

Si alguna de las Partes es objeto de una fusión u otro tipo de reorganización societaria, se acuerda que este Compromiso será vinculante para el que le suceda de acuerdo con la ley aplicable.

| Por el Cliente: | Auditor (Grupo 1) |
| --- | --- |
| Fdo: La Descuidada S.A

Fecha: 21 de marzo de 2024 | Fdo por: 
Adrián Campó Merlo
Eduardo de Motrico Fedriani
Rafael Valverde Cros
Pedro Luis Borrego Vargas

Fecha: 2 de abril de 2024 |

 

---

# Análisis de Vulnerabilidades

## Máquina Windows Server 2008

### **ManageEngine Desktop Central 8 / 9 < Build 91100 Multiple RCE**

(**SUBIDA SIN RESTRICCIONES DE FICHEROS DE TIPOS PELIGROSOS**)

| Descripción: | La aplicación ManageEngine Desktop Central funcionando en el host remoto es versión 8, o la versión 9 antes de la estructura 91100, por lo que es afectado por múltiples vulnerabilidades de código remoto: 

- Un fallo existe en el script statusUpdate debido a un fallo de sanitizar apropiadamente el input de los usuarios en el parámetro ‘fileName’. Un atacante remoto sin autenticar puede explotar esto, mediante una petición creada para subir un archivo PHP que tiene múltiples extensiones de archivo y, mediante la manipulación del parámetro ‘applicationName’, hacen una petición directa al archivo subido, resultando en la ejecución de código arbitrario con privilegios NT-AUTHORITY/SYSTEM.  (CVE-2015-8201)

-Un fallo no especificado existe en varios servlets que permiten a un atacante remoto no autenticado ejecutar código arbitrariamente. No existen más detalles.  |
| --- | --- |
| CVSS v3.0 | 6.0 |
| CVE/CWE | https://nvd.nist.gov/vuln/detail/CVE-2015-82001 |
| Riesgos: | Críticos |
| Impacto: | El atacante puede entrar a la maquina y  a partir, de ahí, conseguir información y permisos necesarios |
| Sistemas | 192.168.106.144 |
| Remediación: | Actualizar ManageEngine Desktop Central versión 9 build 91100 o posterior. |
| Referencias: | https://nvd.nist.gov/vuln/detail/CVE-2015-82001 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled.png)

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%201.png)

### **MySQL Default Account Credentials**

(**Acceso a la base de datos con credenciales por defecto**)

| Descripción: | El componente MySQL en Plixer Scrutinizer v9.0.1.19899 y versiones anteriores tiene una contraseña predeterminada de admin para las cuentas, lo que permite a atacantes remotos ejecutar comandos SQL arbitrarios a través de una sesión TCP. |
| --- | --- |
| CVSS v3.0 | 9.8 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3951 |
| Riesgos: | Críticos |
| Impacto: | Un atacante remoto puede acceder y modificar la BD. |
| Sistemas | 192.168.106.144 |
| Remediación: | Eliminar/cambiar las contraseñas de las cuentas afectadas. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3951,https://nvd.nist.gov/vuln/detail/CVE-2012-3951 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%202.png)

### Apache Tomcat AJP Connector Request Injection (Ghostcat)

| Descripción: | Una vulnerabilidad de lectura/inclusión de archivo ha sido encontrada en el conector AJP. Un atacante remoto no autenticado puede explotar esta vulnerabilidad para leer archivos de aplicaciones web de un servidor vulnerable. En instancias donde el servidor vulnerable permite subidas de archivos, un atacante podría subir códigos de JavaServer Pages (JPS) maliciosos conteniendo una variedad de tipos de archivos y ganar ejecución de códigos remotos (RCE). |
| --- | --- |
| CVSS v3.0 | 9.8 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1745 |
| Riesgos: | Crítico |
| Impacto: | El atacante puede leer documentos que hay dentro del servidor |
| Sistemas | 192.168.106.144 |
| Remediación: | Actualizar la configuración AJP para requerir autorización y/o actualizar el servidor Tomcat a 7.0.100, 8.5.5.51, 9.0.31 o superior |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1745 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%203.png)

### MS11-030: Vulnerability in DNS Resolution Could Allow Remote Code Execution

| Descripción: | Hay un fallo en la forma en el que el cliente DNS de el Windows instalado procesa las consultas de Resolución de Nombre Multicast de Enlace Local (LLMNR) puede ser explotada para ejecutar código arbitario en el contexto de la cuenta Network Service

Es importante tener en cuenta que Windows XP y 2003 no admiten LLMNR y la explotación existosa en esas plataformas requiere acceso local y la capacidad de ejecutar una aplicación especial. Sin embargo, en Windows Vista 2008, 7 y 2008 R2, el porblema puede ser explotado de forma remota. |
| --- | --- |
| CVSS v3.0 | 8.3 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0657 |
| Riesgos: | Críticos |
| Impacto: | Un atacante puede provocar el agotamiento de la pila o potencialmente causar la corrupción de la memoria de la pila y producir  ejecución de código. |
| Sistemas | 192.168.106.144 |
| Remediación: | Microsoft ha lanzado un conjunto de parches para Windows XP, 2003, Vista, 2008, 7 y 2008 R2. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0657 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%204.png)

### **MS17-010: Security Update for Microsoft Windows SMB Server (4013389) (ETERNALBLUE) (ETERNALCHAMPION) (ETERNALROMANCE) (ETERNALSYNERGY) (WannaCry) (EternalRocks) (Petya) (uncredentialed check)**

| Descripción: | El host remoto de Windows se ve afectado por las siguientes vulnerabilidades:

Existen múltiples vulnerabilidades de ejecución remota de código en Microsoft Server Message Block 1.0 (SMBv1) debido al manejo incorrecto de ciertas solicitudes. Un atacante remoto no autenticado puede aprovechar estas vulnerabilidades, a través de un paquete especialmente diseñado, para ejecutar código arbitrario. (CVE-2017-0143, CVE-2017-0144, CVE-2017-0145, CVE-2017-0146, CVE-2017-0148)

Existe una vulnerabilidad de divulgación de información en Microsoft Server Message Block 1.0 (SMBv1) debido al manejo incorrecto de ciertas solicitudes. Un atacante remoto no autenticado puede explotar esto, a través de un paquete especialmente diseñado, para divulgar información sensible. (CVE-2017-0147)

ETERNALBLUE, ETERNALCHAMPION, ETERNALROMANCE y ETERNALSYNERGY son cuatro de múltiples vulnerabilidades y exploits del Grupo Equation divulgados el 14/04/2017 por un grupo conocido como los Shadow Brokers. WannaCry / WannaCrypt es un programa de ransomware que utiliza el exploit ETERNALBLUE, y EternalRocks es un gusano que utiliza siete vulnerabilidades del Grupo Equation. Petya es un programa de ransomware que primero utiliza CVE-2017-0199, una vulnerabilidad en Microsoft Office, y luego se propaga a través de ETERNALBLUE. |
| --- | --- |
| CVSS v3.0 | 8.1 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0145, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0146, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0147, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0148 |
| Riesgos: | Alto |
| Impacto: | Permite a atacantes remotos ejecutar código arbitrario a través de paquetes manipulados. |
| Sistemas | 192.168.106.144 |
| Remediación: | Microsoft ha lanzado un conjunto de parches para Windows Vista, 2008, 7, 2008 R2, 2012, 8.1, RT 8.1, 2012 R2, 10 y 2016. Microsoft también ha lanzado parches de emergencia para sistemas operativos Windows que ya no cuentan con soporte, incluidos Windows XP, 2003 y 8.

Para sistemas operativos Windows no compatibles, como Windows XP, Microsoft recomienda que los usuarios dejen de utilizar SMBv1. SMBv1 carece de características de seguridad que se incluyeron en versiones posteriores de SMB. SMBv1 se puede desactivar siguiendo las instrucciones del proveedor proporcionadas en Microsoft KB2696547. Además, el US-CERT recomienda que los usuarios bloqueen SMB directamente bloqueando el puerto TCP 445 en todos los dispositivos de límite de red. Para SMB sobre la API NetBIOS, bloquee los puertos TCP 137/139 y los puertos UDP 137/138 en todos los dispositivos de límite de red. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0145, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0146, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0147, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0148 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%205.png)

### **MS12-020: Vulnerabilities in Remote Desktop Could Allow Remote Code Execution**

| Descripción: | Existe una vulnerabilidad de código remoto arbitrario en la implementación del Protocolo de Escritorio Remoto (RDP) en el host remoto de Windows. La vulnerabilidad se debe a la forma en que RDP accede a un objeto en memoria que se ha inicializado incorrectamente o se ha eliminado.

Si se ha habilitado RDP en el sistema afectado, un atacante remoto no autenticado podría aprovechar esta vulnerabilidad para hacer que el sistema ejecute código arbitrario enviándole una secuencia de paquetes RDP especialmente diseñados.

Este complemento también comprueba una vulnerabilidad de denegación de servicio en Microsoft Terminal Server. |
| --- | --- |
| CVSS v3.0 | 5.9 |
| CVE/CWE | http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0152, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0002 |
| Riesgos: | Críticos |
| Impacto: | Permite al atacante realizar un ataque de denegación de servicio, apagando el equipo. |
| Sistemas | 192.168.106.144 |
| Remediación: | Microsoft ha publicado un conjunto de parches para Windows XP, 2003, Vista, 2008, 7 y 2008 R2. |
| Referencias: | https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2012/ms12-020?redirectedfrom=MSDN |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%206.png)

### **Information Exposure**

| Descripción: | El producto expone información confidencial a un tercero que no está explícitamente autorizado a tener acceso a esa información. |
| --- | --- |
| CVSS v3.0 | - |
| CVE/CWE | https://cwe.mitre.org/data/definitions/200.html |
| Riesgos: | Medio |
| Impacto: | Permite al atacante conocer la ubicación del fichero con las credenciales. |
| Sistemas | 192.168.106.144 |
| Remediación: | Ajustar las configuraciones para prevenir inputs de los usuarios de manera directa, evitando que pueda hacer rutas directas al servidor. |
| Referencias: | https://capec.mitre.org/data/definitions/170.html |
| Prueba de Concepto |  |

![tomcatinforma.png](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/tomcatinforma.png)

## OpenSSH User enumeration vulnerability

| Descripción: | Esta vulnerabilidad persiste en los OpenSSH que llegan hasta la versión 7.7, provocando que no se llegue a echar al usuario en una autenticación fallida hasta que el paquete no haya sido totalmente parseado, pudiendo de esa forma revelar información sensible. |
| --- | --- |
| CVSS v3.0 | 5.3 |
| CVE/CWE | https://nvd.nist.gov/vuln/detail/CVE-2018-15473 |
| Riesgos: | Medio |
| Impacto: | Permite al atacante obtener información sensible. |
| Sistemas | 192.168.106.144 |
| Remediación: | Actualizar el OpenSSH a una versión posterior del 7.7 |
| Referencias: | https://medium.com/@lcolin250/openssh-7-7-vulnerability-b6886e82f6f6 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%207.png)

### **SNMP Agent Default Community Name (public)**

| Descripción: | Es posible obtener el nombre de comunidad predeterminado del servidor SNMP remoto.

Un atacante podría utilizar esta información para obtener más conocimiento sobre el host remoto, o para cambiar la configuración del sistema remoto (si la comunidad predeterminada permite tales modificaciones). |
| --- | --- |
| CVSS v3.0 | 7.5 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0517 |
| Riesgos: | Alto |
| Impacto: | El atacante puede enumerar la información que ha conseguido, modificar la configuración del sistema y amenazar la confidencialidad y seguridad del equipo |
| Sistemas | 192.168.106.144 |
| Remediación: | Desactiva el servicio SNMP en el host remoto si no lo estás utilizando.
O bien filtra los paquetes UDP entrantes que van a este puerto, o cambia la cadena de comunidad predeterminada. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0517 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%208.png)

### **Microsoft Windows LAN Manager SNMP LanMan Services Disclosure**

| Descripción: | Es posible obtener la lista de servicios LanMan en el host remoto enviando solicitudes SNMP con el OID 1.3.6.1.4.1.77.1.2.3.1.1.

Un atacante podría utilizar esta información para obtener más conocimiento sobre el host objetivo. |
| --- | --- |
| CVSS v3.0 | 7.3 |
| CVE/CWE | https://nvd.nist.gov/vuln/detail/CVE-1999-0499 |
| Riesgos: | Alto |
| Impacto: | Un atacante puede obtener información valiosa sobre la configuración y los servicios habilitados |
| Sistemas | 192.168.106.144 |
| Remediación: | Desactiva el servicio SNMP en el host remoto si no lo estás utilizando, o filtra los paquetes UDP entrantes dirigidos a este puerto.e. |
| Referencias: | https://nvd.nist.gov/vuln/detail/CVE-1999-0499 |
| Prueba de Concepto |  |

![snmpservices.png](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/snmpservices.png)

### Microsoft Windows LAN Manager SNMP LanMan Users Disclosure

| Descripción: | Es posible obtener el nombre de comunidad predeterminado del servidor SNMP remoto.

Un atacante podría utilizar esta información para obtener más conocimiento sobre el host remoto, o para cambiar la configuración del sistema remoto (si la comunidad predeterminada permite tales modificaciones). |
| --- | --- |
| CVSS v3.0 | 7.5 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0517 |
| Riesgos: | Alto |
| Impacto: | Un atacante podría obtener información del host remoto, también tiene posibilidad de cambiar la configuración del sistema, amenaza a la confidencialidad, integridad y disponibilidad e incluso facilita la probabilidad de que se hagan más ataques. |
| Sistemas | 192.168.106.144 |
| Remediación: | Desactiva el servicio SNMP en el host remoto si no lo estás utilizando.
O bien filtra los paquetes UDP entrantes que van a este puerto, o cambia la cadena de comunidad predeterminada. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0517 |
| Prueba de Concepto |  |

![snmp users.png](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/snmp_users.png)

## Máquina Windows Server 2016

### MS17-010: Security Update for Microsoft Windows SMB Server (4013389)(ETERNALBLUE)(ETERNALCHAMPION)(ETERNALROMANCE)(ETERNALSYNERGY)(WannaCry)(EternalRocks)(Petyal)(uncredentialed check)

(**VALIDACIÓN INCORRECTA DE ENTRADA**)

| Descripción: | El host remoto Windows es afectado por las siguientes vulnerabilidades:

- Múltiples vulnerabilidades de ejecución de código remoto existen en Microsoft Server Message Block 1.0 (SMBv1) debido a un manejo inapropiado de ciertas peticiones. Un atacante remoto unautenticado puede explotar estas vulnerabilidades, mediante un paquete especialmente creado, para ejecutar código arbitrariamente.

- Una vulnerabilidad de filtrado de información existe en Microsoft Server Message Block 1.0 (SMBv1) debido a un manejo inapropiado de ciertas peticiones. Un atacante remoto unautenticado puede explotar estas vulnerabilidades, mediante un paquete especialmente creado, para revelar la información.

ETERNALBLUE, ETERNALCHAMPION, ETERNALROMANCE y ETERNALSYNERGY son cuatro de múltiples vulnerabilidades y exploits Equation Groups, desvelados en 2017/04/14 por un grupo conocido como los Shadow Brokers. WannaCry / WannaCrypt es un programa ransomware que utiliza el exploit ETERNALBLUE, y EternalRocks es un gusano que utiliza siete vulneravilidades de Equation Group. Petya es un programa ransomware que primero utiliza CVE-2017-0199, una vulnerabilidad en Microsoft Office, y luego lo extiende mediante ETERNALBLUE |
| --- | --- |
| CVSS v3.0 | 8.1 |
| CVE/CWE | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0148, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0147, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0146, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0145, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |
| Riesgos: | Alto |
| Impacto: | Permite a atacantes remotos ejecutar código arbitrario a través de paquetes manipulados. |
| Sistemas | 192.168.1.78 |
| Remediación: | Microsoft ha realizado una serie de parches para Windows Vista, 2008, 7, 2008 R2, 2012, 8.1, RT 8.1, 2012 R2, 10, y 2016. Microsoft ha realizado también parches de emergencia para sistemas operativos Windows que ya no están soportados, incluyendo Windows XP, 2003 y 8.

Para sistemas operativos Windows no soportados, Microsoft recomienda que los usuarios dejen de usar el SMBv1. SMBv1 carece de las características de seguridad que fueron incluidas en versiones SMB posteriores. SMBv1 puede ser deshabilitado siguiendo las instrucciones del vendedor dadas en Microsoft KB2696547. Adicionalmente, US-CERT recomienda que el usuario bloquee SMB directamente mediante el bloqueo del puerto TCP 445 en todos los dispositivos de red. Para SMB en el NetBIOS API, bloquea los puertos TCP 137 / 139 y los puertos UDP 1137 /138 en todos los dispositivos de red. |
| Referencias: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0148, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0147, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0146, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0145, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |
| Prueba de Concepto |  |

![Untitled](Informe%20de%20El%20Ventanal%20de%20Guillermo%20e760fb54ec7d48e387ad9a06906fdfc9/Untitled%209.png)